<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ì¹´ì¹´ì˜¤ API ì˜¤ë¥˜ ì§„ë‹¨</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #333; border-bottom: 3px solid #FEE500; padding-bottom: 10px; }
        h2 { color: #555; margin-top: 30px; }
        #map {
            width: 100%;
            height: 400px;
            border: 3px solid #333;
            margin: 20px 0;
            background: #e0e0e0;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 5px solid;
        }
        .success { background: #d4edda; color: #155724; border-left-color: #28a745; }
        .error { background: #f8d7da; color: #721c24; border-left-color: #dc3545; }
        .warning { background: #fff3cd; color: #856404; border-left-color: #ffc107; }
        .info { background: #d1ecf1; color: #0c5460; border-left-color: #17a2b8; }
        pre {
            background: #f8f9fa;
            padding: 15px;
            overflow-x: auto;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            font-size: 12px;
        }
        .highlight {
            background: #fff3cd;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .step {
            background: #e7f3ff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 5px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ì¹´ì¹´ì˜¤ ì§€ë„ API ì˜¤ë¥˜ ì§„ë‹¨</h1>

        <div class="info status">
            <strong>í˜„ì¬ í˜ì´ì§€:</strong> <span id="currentUrl"></span><br>
            <strong>API í‚¤:</strong> <code>29b5e465ce1f0e75c0c79be6671c8232</code>
        </div>

        <div id="statusLog"></div>

        <h2>ğŸ“ ì§€ë„ í…ŒìŠ¤íŠ¸ ì˜ì—­</h2>
        <div id="map"></div>

        <div id="errorDetails"></div>

        <div class="step" id="solution" style="display:none;">
            <h2>âœ… í•´ê²° ë°©ë²•</h2>
            <div id="solutionContent"></div>
        </div>
    </div>

    <script>
        const statusLog = document.getElementById('statusLog');
        const errorDetails = document.getElementById('errorDetails');
        const solution = document.getElementById('solution');
        const solutionContent = document.getElementById('solutionContent');

        document.getElementById('currentUrl').textContent = window.location.href;

        function log(msg, type = 'info', details = '') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${msg}</strong>${details ? '<br>' + details : ''}`;
            statusLog.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${msg}`, details);
        }

        function showError(title, message, solutionText = '') {
            errorDetails.innerHTML = `
                <h2 style="color: #dc3545;">âŒ ${title}</h2>
                <div class="error status">
                    <pre>${message}</pre>
                </div>
            `;

            if (solutionText) {
                solution.style.display = 'block';
                solutionContent.innerHTML = solutionText;
            }
        }

        // ì „ì—­ ì—ëŸ¬ ìº¡ì²˜
        const errors = [];
        window.onerror = function(msg, url, line, col, error) {
            errors.push({ msg, url, line, col, error: error ? error.stack : '' });
            log(`JavaScript ì˜¤ë¥˜ ë°œìƒ`, 'error', `${msg}<br>ìœ„ì¹˜: ${url}:${line}:${col}`);
            return false;
        };

        // Console ì—ëŸ¬ ìº¡ì²˜
        const originalConsoleError = console.error;
        console.error = function(...args) {
            log('Console Error', 'error', args.join(' '));
            originalConsoleError.apply(console, args);
        };

        log('í™˜ê²½ ì •ë³´ í™•ì¸', 'info', `
            í”„ë¡œí† ì½œ: ${window.location.protocol}<br>
            í˜¸ìŠ¤íŠ¸: ${window.location.host || '(ë¡œì»¬ íŒŒì¼)'}<br>
            ì „ì²´ URL: ${window.location.href}
        `);

    </script>

    <!-- ì¹´ì¹´ì˜¤ ì§€ë„ SDK ë¡œë“œ -->
    <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=29b5e465ce1f0e75c0c79be6671c8232&autoload=false"></script>

    <script>
        log('ì¹´ì¹´ì˜¤ SDK ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹œë„', 'info');

        setTimeout(() => {
            // SDK ë¡œë“œ í™•ì¸
            if (typeof kakao === 'undefined') {
                log('kakao ê°ì²´ ë¡œë“œ ì‹¤íŒ¨', 'error');
                showError(
                    'SDK ë¡œë“œ ì‹¤íŒ¨',
                    'kakao ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nAPI í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                    `
                    <p><strong>ê°€ëŠ¥í•œ ì›ì¸:</strong></p>
                    <ol>
                        <li>API í‚¤ê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ë¹„í™œì„±í™”ë¨</li>
                        <li>ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¬¸ì œ</li>
                        <li>ì¹´ì¹´ì˜¤ ì„œë²„ ë¬¸ì œ</li>
                    </ol>
                    <p><strong>í™•ì¸ ë°©ë²•:</strong></p>
                    <p>ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(F12) â†’ Network íƒ­ì—ì„œ <code>sdk.js</code> ìš”ì²­ ìƒíƒœ í™•ì¸</p>
                    `
                );
                return;
            }

            log('kakao ê°ì²´ ë¡œë“œ ì„±ê³µ âœ“', 'success');

            if (typeof kakao.maps === 'undefined') {
                log('kakao.maps ê°ì²´ ì—†ìŒ', 'error');
                return;
            }

            log('kakao.maps ê°ì²´ í™•ì¸ âœ“', 'success');

            // ì§€ë„ ë¡œë“œ ì‹œë„
            log('ì§€ë„ ì´ˆê¸°í™” ì‹œë„ ì¤‘...', 'info');

            kakao.maps.load(() => {
                log('kakao.maps.load() ì½œë°± ì‹¤í–‰ë¨ âœ“', 'success');

                try {
                    const container = document.getElementById('map');
                    const options = {
                        center: new kakao.maps.LatLng(37.5665, 126.9780),
                        level: 8
                    };

                    log('ì§€ë„ ìƒì„± ì‹œë„...', 'info');
                    const map = new kakao.maps.Map(container, options);

                    log('ğŸ‰ ì§€ë„ ìƒì„± ì„±ê³µ!', 'success', 'ì§€ë„ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.');

                    // ë§ˆì»¤ ì¶”ê°€
                    const marker = new kakao.maps.Marker({
                        position: new kakao.maps.LatLng(37.5665, 126.9780)
                    });
                    marker.setMap(map);

                    log('ë§ˆì»¤ ì¶”ê°€ ì™„ë£Œ âœ“', 'success');

                    solution.style.display = 'block';
                    solutionContent.innerHTML = `
                        <div class="success status">
                            <h3>âœ… APIê°€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!</h3>
                            <p>ì´ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ì—ì„œ ì§€ë„ê°€ ë³´ì¸ë‹¤ë©´, ì›ë³¸ index.html íŒŒì¼ì— ë‹¤ë¥¸ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            <p><strong>ë‹¤ìŒ ë‹¨ê³„:</strong></p>
                            <ol>
                                <li>ì›ë³¸ HTML íŒŒì¼ì˜ JavaScript ì˜¤ë¥˜ í™•ì¸</li>
                                <li>ë°ì´í„° í¬ê¸° ë¬¸ì œ í™•ì¸ (9MB+ íŒŒì¼)</li>
                                <li>ë¸Œë¼ìš°ì € ë©”ëª¨ë¦¬ ë¬¸ì œ í™•ì¸</li>
                            </ol>
                        </div>
                    `;

                } catch (error) {
                    log('ì§€ë„ ìƒì„± ì‹¤íŒ¨', 'error', error.message);

                    // ë„ë©”ì¸ ì¸ì¦ ì˜¤ë¥˜ ì²´í¬
                    if (error.message.includes('ë¬´ë‹¨ ì‚¬ìš©') ||
                        error.message.includes('Authentication') ||
                        error.message.includes('authorized') ||
                        error.message.includes('domain')) {

                        showError(
                            'ë„ë©”ì¸ ì¸ì¦ ì‹¤íŒ¨',
                            error.message + '\n\n' + (error.stack || ''),
                            `
                            <div class="warning status">
                                <h3>âš ï¸ ì¹´ì¹´ì˜¤ API í‚¤ ë„ë©”ì¸ ë“±ë¡ í•„ìš”</h3>
                                <p>í˜„ì¬ ë„ë©”ì¸(<span class="highlight">${window.location.hostname}</span>)ì´ API í‚¤ì— ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>

                                <h4>í•´ê²° ë°©ë²•:</h4>
                                <ol>
                                    <li><a href="https://developers.kakao.com" target="_blank">ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”</a>ì— ë¡œê·¸ì¸</li>
                                    <li><strong>ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜</strong> â†’ í•´ë‹¹ ì•± ì„ íƒ</li>
                                    <li><strong>ì•± ì„¤ì •</strong> â†’ <strong>í”Œë«í¼</strong> ë©”ë‰´</li>
                                    <li><strong>Web í”Œë«í¼ ë“±ë¡</strong> í´ë¦­</li>
                                    <li>ì‚¬ì´íŠ¸ ë„ë©”ì¸ì— ë‹¤ìŒ ì¶”ê°€:
                                        <pre>http://localhost
http://127.0.0.1
https://c820131-bit.github.io</pre>
                                    </li>
                                    <li><strong>ì €ì¥</strong> í´ë¦­</li>
                                </ol>

                                <p><strong>í˜„ì¬ API í‚¤:</strong> <code>29b5e465ce1f0e75c0c79be6671c8232</code></p>
                            </div>
                            `
                        );
                    } else {
                        showError(
                            'ì§€ë„ ìƒì„± ì¤‘ ì˜¤ë¥˜',
                            error.message + '\n\n' + (error.stack || ''),
                            `
                            <p>ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
                            <p>ë¸Œë¼ìš°ì € ì½˜ì†”(F12)ì—ì„œ ìì„¸í•œ ì˜¤ë¥˜ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                            `
                        );
                    }

                    console.error('Full error:', error);
                }
            });

        }, 1500); // SDK ë¡œë”© ëŒ€ê¸°

        // 5ì´ˆ í›„ì—ë„ ì§€ë„ê°€ ì•ˆ ë³´ì´ë©´ íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
        setTimeout(() => {
            if (errors.length > 0) {
                log('íƒ€ì„ì•„ì›ƒ: ì—¬ëŸ¬ ì˜¤ë¥˜ ë°œìƒ', 'error');
                errorDetails.innerHTML += `
                    <h3>ë°œìƒí•œ ëª¨ë“  ì˜¤ë¥˜:</h3>
                    <pre>${JSON.stringify(errors, null, 2)}</pre>
                `;
            }
        }, 5000);
    </script>
</body>
</html>
